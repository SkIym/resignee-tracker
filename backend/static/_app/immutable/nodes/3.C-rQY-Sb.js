import{f as H,a as k,d as Q}from"../chunks/bgre1PTG.js";import{i as Ee}from"../chunks/SOPnzMaR.js";import{c as Ot,o as $t}from"../chunks/DbyfWEYX.js";import{k as Oe,h as ie,a8 as Bt,a7 as Ht,e as Pt,d as jt,g as e,P as Pe,f as Vt,i as Yt,j as Qe,l as $e,u as ke,an as Zt,n as ct,o as dt,q as qt,aq as ut,F as Wt,m as j,aw as et,ax as Be,aa as tt,ay as Ze,az as at,aA as Gt,ad as Jt,aB as Kt,a6 as Xt,aC as qe,aD as Qt,ak as ea,aE as vt,L as ta,aF as aa,p as _e,aG as ft,b as f,B as ra,aH as pt,aI as sa,c as v,s as _,r as d,aJ as je,t as ce,I as rt,a as xe,x as na,at as st,$ as oa}from"../chunks/BKZzm82k.js";import{e as B,s as te,d as ia,h as la,r as ca}from"../chunks/BDimp7fF.js";import{i as Y}from"../chunks/Be2-HqVZ.js";import{r as le,s as ht,b as pe,B as fe,a as da,c as ua}from"../chunks/M8bK7g7j.js";import{g as gt}from"../chunks/41icJ5db.js";import{p as Ve,b as va}from"../chunks/LWGFU2bj.js";function nt(r,t){return t}function fa(r,t,a,s){for(var o=[],n=t.length,i=0;i<n;i++)Gt(t[i].e,o,!0);var p=n>0&&o.length===0&&a!==null;if(p){var g=a.parentNode;Jt(g),g.append(a),s.clear(),ve(r,t[0].prev,t[n-1].next)}Kt(o,()=>{for(var l=0;l<n;l++){var x=t[l];p||(s.delete(x.k),ve(r,x.prev,x.next)),Xt(x.e,!p)}})}function Ye(r,t,a,s,o,n=null){var i=r,p={flags:t,items:new Map,first:null},g=(t&vt)!==0;if(g){var l=r;i=ie?Oe(Bt(l)):l.appendChild(Ht())}ie&&Pt();var x=null,K=!1,D=Pe(()=>{var T=a();return Wt(T)?T:T==null?[]:ut(T)});jt(()=>{var T=e(D),b=T.length;if(K&&b===0)return;K=b===0;let Z=!1;if(ie){var q=Vt(i)===Yt;q!==(b===0)&&(i=Qe(),Oe(i),$e(!1),Z=!0)}if(ie){for(var F=null,W,O=0;O<b;O++){if(ke.nodeType===8&&ke.data===Zt){i=ke,Z=!0,$e(!1);break}var w=T[O],S=s(w,O);W=mt(ke,p,F,null,w,S,O,o,t,a),p.items.set(S,W),F=W}b>0&&Oe(Qe())}ie||pa(T,p,i,o,t,s,a),n!==null&&(b===0?x?ct(x):x=dt(()=>n(i)):x!==null&&qt(x,()=>{x=null})),Z&&$e(!0),e(D)}),ie&&(i=ke)}function pa(r,t,a,s,o,n,i){var re,se,U,R;var p=(o&aa)!==0,g=(o&(qe|Ze))!==0,l=r.length,x=t.items,K=t.first,D=K,T,b=null,Z,q=[],F=[],W,O,w,S;if(p)for(S=0;S<l;S+=1)W=r[S],O=n(W,S),w=x.get(O),w!==void 0&&((re=w.a)==null||re.measure(),(Z??(Z=new Set)).add(w));for(S=0;S<l;S+=1){if(W=r[S],O=n(W,S),w=x.get(O),w===void 0){var de=D?D.e.nodes_start:a;b=mt(de,t,b,b===null?t.first:b.next,W,O,S,s,o,i),x.set(O,b),q=[],F=[],D=b.next;continue}if(g&&ha(w,W,S,o),(w.e.f&Be)!==0&&(ct(w.e),p&&((se=w.a)==null||se.unfix(),(Z??(Z=new Set)).delete(w))),w!==D){if(T!==void 0&&T.has(w)){if(q.length<F.length){var N=F[0],C;b=N.prev;var J=q[0],X=q[q.length-1];for(C=0;C<q.length;C+=1)ot(q[C],N,a);for(C=0;C<F.length;C+=1)T.delete(F[C]);ve(t,J.prev,X.next),ve(t,b,J),ve(t,X,N),D=N,b=X,S-=1,q=[],F=[]}else T.delete(w),ot(w,D,a),ve(t,w.prev,w.next),ve(t,w,b===null?t.first:b.next),ve(t,b,w),b=w;continue}for(q=[],F=[];D!==null&&D.k!==O;)(D.e.f&Be)===0&&(T??(T=new Set)).add(D),F.push(D),D=D.next;if(D===null)continue;w=D}q.push(w),b=w,D=w.next}if(D!==null||T!==void 0){for(var I=T===void 0?[]:ut(T);D!==null;)(D.e.f&Be)===0&&I.push(D),D=D.next;var ee=I.length;if(ee>0){var ae=(o&vt)!==0&&l===0?a:null;if(p){for(S=0;S<ee;S+=1)(U=I[S].a)==null||U.measure();for(S=0;S<ee;S+=1)(R=I[S].a)==null||R.fix()}fa(t,I,ae,x)}}p&&ta(()=>{var V;if(Z!==void 0)for(w of Z)(V=w.a)==null||V.apply()}),tt.first=t.first&&t.first.e,tt.last=b&&b.e}function ha(r,t,a,s){(s&qe)!==0&&at(r.v,t),(s&Ze)!==0?at(r.i,a):r.i=a}function mt(r,t,a,s,o,n,i,p,g,l){var x=(g&qe)!==0,K=(g&Qt)===0,D=x?K?j(o,!1,!1):et(o):o,T=(g&Ze)===0?i:et(i),b={i:T,v:D,k:n,a:null,e:null,prev:a,next:s};try{return b.e=dt(()=>p(r,D,T,l),ie),b.e.prev=a&&a.e,b.e.next=s&&s.e,a===null?t.first=b:(a.next=b,a.e.next=b.e),s!==null&&(s.prev=b,s.e.prev=b.e),b}finally{}}function ot(r,t,a){for(var s=r.next?r.next.e.nodes_start:a,o=t?t.e.nodes_start:a,n=r.e.nodes_start;n!==s;){var i=ea(n);o.before(n),n=i}}function ve(r,t,a){t===null?r.first=a:(t.next=a,t.e.next=a&&a.e),a!==null&&(a.prev=t,a.e.prev=t&&t.e)}function ga(r,t,a){var s=r==null?"":""+r;return s===""?null:s}function _t(r,t,a,s,o,n){var i=r.__className;if(ie||i!==a||i===void 0){var p=ga(a);(!ie||p!==r.getAttribute("class"))&&(p==null?r.removeAttribute("class"):r.className=p),r.__className=a}return n}function ma(r){return function(...t){var a=t[0];return a.preventDefault(),r==null?void 0:r.apply(this,t)}}var _a=Q('<path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z"></path>'),xa=Q('<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>'),ba=Q('<path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"></path>'),ya=Q('<path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z"></path>'),wa=Q('<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>'),ka=Q('<path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"></path>'),Da=Q('<path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z"></path>'),Ea=Q('<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>'),Sa=Q('<path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"></path>'),La=Q('<path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z"></path>'),Ta=Q('<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>'),Ca=Q('<path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"></path>'),za=Q('<path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z"></path>'),Na=Q('<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"></path>'),Ma=Q('<path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"></path>'),Aa=H('<input type="date" class="text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/> <button type="button" class="text-green-600 hover:text-green-800 transition-colors" title="Save changes"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button>',1),Fa=H('<span class="flex-1"> </span> <button type="button" class="text-gray-400 hover:text-gray-600 transition-colors" title="Edit last day"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button>',1),Ia=H('<tr class="hover:bg-gray-50 transition-colors"><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><div class="flex items-center gap-2"><!></div></td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><input type="checkbox" class="w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500"/></td></tr>'),Ua=H('<div class="text-center py-12"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No employees found</h3></div>'),Ra=H('<div class="overflow-x-auto"><table class="min-w-full text-sm text-left text-gray-700 bg-white"><thead class="bg-gray-100 text-xs text-gray-500 uppercase"><tr><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors"><div class="flex items-center gap-1">Employee no. <svg class="w-4 h-4 shrink-0" fill="currentColor" viewBox="0 0 20 20"><!></svg></div></th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors"><div class="flex items-center gap-1">Date hired <svg class="w-4 h-4 shrink-0" fill="currentColor" viewBox="0 0 20 20"><!></svg></div></th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Cost center</th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors"><div class="flex items-center gap-1">Name <svg class="w-4 h-4 shrink-0" fill="currentColor" viewBox="0 0 20 20"><!></svg></div></th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Position title</th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Rank</th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors"><div class="flex items-center gap-1">Department <svg class="w-4 h-4 shrink-0" fill="currentColor" viewBox="0 0 20 20"><!></svg></div></th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors"><div class="flex items-center gap-1">Last day <svg class="w-4 h-4 shrink-0" fill="currentColor" viewBox="0 0 20 20"><!></svg></div></th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Mark as Processed</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table> <!></div>');function Oa(r,t){_e(t,!1);const a=j();let s=Ve(t,"employees",28,()=>[]),o=Ve(t,"onstatustoggle",8),n=j(""),i=j("asc"),p=j(null),g=j("");function l(c){e(n)==c?f(i,e(i)==="asc"?"desc":"asc"):(f(n,c),f(i,"asc"))}function x(c){return c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function K(c){if(!c)return"";const h=new Date(c),$=h.getFullYear(),P=String(h.getMonth()+1).padStart(2,"0"),m=String(h.getDate()).padStart(2,"0");return`${$}-${P}-${m}`}function D(c){f(p,c.employee_no),f(g,K(c.last_day))}async function T(c){try{const h=e(g).trim(),$=new Date(h);if(!h||isNaN($.getTime()))throw new Error("Invalid date format");const P=await fetch(`${fe}/resignees/${c.employee_no}/last_day/edit`,{method:"PUT",headers:{"Content-Type":"text/plain"},body:h,credentials:"include"});if(!P.ok){const z=await P.text();throw new Error(`Error ${P.status}: ${z}`)}const m=s().findIndex(z=>z.employee_no===c.employee_no);m!==-1&&(s(s()[m].last_day=$.toISOString(),!0),s([...s()]))}catch(h){console.error("Error updating last day:",h);const $=h instanceof Error?h.message:"Unknown error";alert(`Failed to update last day: ${$}`)}finally{f(p,null),f(g,"")}}function b(){f(p,null),f(g,"")}function Z(c){c.processed_date_time,o()&&o()({detail:{employee:c}})}function q(c){c.key==="Escape"&&b()}ft(()=>(ra(s()),e(n),e(i)),()=>{f(a,[...s()].sort((c,h)=>{if(!e(n))return 0;let $=c[e(n)],P=h[e(n)];if(e(n)==="date_hired"||e(n)==="last_day"){const Se=new Date($||"1900-01-01"),me=new Date(P||"1900-01-01");return Se<me?e(i)==="asc"?-1:1:Se>me?e(i)==="asc"?1:-1:0}const m=String($||""),z=String(P||"");return m<z?e(i)==="asc"?-1:1:m>z?e(i)==="asc"?1:-1:0}))}),pt(),Ee();var F=Ra();B("keydown",sa,q);var W=v(F),O=v(W),w=v(O),S=v(w),de=v(S),N=_(v(de)),C=v(N);{var J=c=>{var h=_a();k(c,h)},X=(c,h)=>{{var $=m=>{var z=xa();k(m,z)},P=m=>{var z=ba();k(m,z)};Y(c,m=>{e(n)==="employee_no"&&e(i)==="desc"?m($):m(P,!1)},h)}};Y(C,c=>{e(n)==="employee_no"&&e(i)==="asc"?c(J):c(X,!1)})}d(N),d(de),d(S);var I=_(S),ee=v(I),ae=_(v(ee)),re=v(ae);{var se=c=>{var h=ya();k(c,h)},U=(c,h)=>{{var $=m=>{var z=wa();k(m,z)},P=m=>{var z=ka();k(m,z)};Y(c,m=>{e(n)==="date_hired"&&e(i)==="desc"?m($):m(P,!1)},h)}};Y(re,c=>{e(n)==="date_hired"&&e(i)==="asc"?c(se):c(U,!1)})}d(ae),d(ee),d(I);var R=_(I,2),V=v(R),G=_(v(V)),u=v(G);{var E=c=>{var h=Da();k(c,h)},L=(c,h)=>{{var $=m=>{var z=Ea();k(m,z)},P=m=>{var z=Sa();k(m,z)};Y(c,m=>{e(n)==="name"&&e(i)==="desc"?m($):m(P,!1)},h)}};Y(u,c=>{e(n)==="name"&&e(i)==="asc"?c(E):c(L,!1)})}d(G),d(V),d(R);var y=_(R,3),M=v(y),A=_(v(M)),oe=v(A);{var he=c=>{var h=La();k(c,h)},Te=(c,h)=>{{var $=m=>{var z=Ta();k(m,z)},P=m=>{var z=Ca();k(m,z)};Y(c,m=>{e(n)==="department"&&e(i)==="desc"?m($):m(P,!1)},h)}};Y(oe,c=>{e(n)==="department"&&e(i)==="asc"?c(he):c(Te,!1)})}d(A),d(M),d(y);var be=_(y),We=v(be),Ge=_(v(We)),kt=v(Ge);{var Dt=c=>{var h=za();k(c,h)},Et=(c,h)=>{{var $=m=>{var z=Na();k(m,z)},P=m=>{var z=Ma();k(m,z)};Y(c,m=>{e(n)==="last_day"&&e(i)==="desc"?m($):m(P,!1)},h)}};Y(kt,c=>{e(n)==="last_day"&&e(i)==="asc"?c(Dt):c(Et,!1)})}d(Ge),d(We),d(be),je(2),d(w),d(O);var Je=_(O);Ye(Je,7,()=>e(a),c=>c.employee_no,(c,h)=>{var $=Ia(),P=v($),m=v(P,!0);d(P);var z=_(P),Se=v(z,!0);d(z);var me=_(z),Tt=v(me,!0);d(me);var Ce=_(me),Ct=v(Ce,!0);d(Ce);var ze=_(Ce),zt=v(ze,!0);d(ze);var Ne=_(ze),Nt=v(Ne,!0);d(Ne);var Me=_(Ne),Mt=v(Me,!0);d(Me);var Ae=_(Me),Ke=v(Ae),At=v(Ke);{var Ft=ue=>{var ge=Aa(),ne=rt(ge);le(ne);var ye=_(ne,2);pe(ne,()=>e(g),we=>f(g,we)),B("blur",ne,()=>T(e(h))),B("click",ye,()=>T(e(h))),k(ue,ge)},It=ue=>{var ge=Fa(),ne=rt(ge),ye=v(ne,!0);d(ne);var we=_(ne,2);ce(Re=>te(ye,Re),[()=>x(e(h).last_day)],Pe),B("click",we,()=>D(e(h))),k(ue,ge)};Y(At,ue=>{e(p)===e(h).employee_no?ue(Ft):ue(It,!1)})}d(Ke),d(Ae);var Fe=_(Ae),Ie=v(Fe),Ut=v(Ie,!0);d(Ie),d(Fe);var Xe=_(Fe),Ue=v(Xe);le(Ue),d(Xe),d($),ce((ue,ge,ne,ye,we,Re,Rt)=>{te(m,ue),te(Se,ge),te(Tt,ne),te(Ct,ye),te(zt,we),te(Nt,Re),te(Mt,Rt),_t(Ie,1,`inline-flex px-2 py-1 text-xs font-medium rounded-full ${e(h).processed_date_time?"bg-[#CFEED8] text-[#1E9F37]":"bg-[#FED9DA] text-[#D7313E]"}`),te(Ut,e(h).processed_date_time?"Processed":"Unprocessed"),ht(Ue,e(h).processed_date_time!==null)},[()=>String(e(h).employee_no||""),()=>x(e(h).date_hired),()=>String(e(h).cost_center||""),()=>String(e(h).name||""),()=>String(e(h).position_title||""),()=>String(e(h).rank||""),()=>String(e(h).department||"")],Pe),B("change",Ue,()=>Z(e(h))),k(c,$)}),d(Je),d(W);var St=_(W,2);{var Lt=c=>{var h=Ua();k(c,h)};Y(St,c=>{e(a).length===0&&c(Lt)})}d(F),B("click",S,()=>l("employee_no")),B("click",I,()=>l("date_hired")),B("click",R,()=>l("name")),B("click",y,()=>l("department")),B("click",be,()=>l("last_day")),k(r,F),xe()}function $a(r,t,a,s){var o;f(t,""),a(),(o=e(s))==null||o.focus()}var Ba=H('<div class="absolute inset-y-0 right-0 pr-3 flex items-center"><button class="text-gray-400 hover:text-gray-600 focus:outline-none transition-colors" aria-label="Clear search"><svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),Ha=H('<div class="relative flex-1 min-w-[200px] max-w-md"><div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M17 10a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> <input type="text" placeholder="Search" class="block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-3xl"/> <!></div>');function Pa(r,t){_e(t,!0);let a=st(""),s=st(void 0);function o(){var l;(l=t.onsearch)==null||l.call(t,{searchTerm:e(a)})}na(()=>{o()});var n=Ha(),i=_(v(n),2);le(i),i.__input=o,va(i,l=>f(s,l),()=>e(s));var p=_(i,2);{var g=l=>{var x=Ba(),K=v(x);K.__click=[$a,a,o,s],d(x),k(l,x)};Y(p,l=>{e(a)&&l(g)})}d(n),pe(i,()=>e(a),l=>f(a,l)),k(r,n),xe()}ia(["input","click"]);const xt=6e4,bt=36e5,it=Symbol.for("constructDateFrom");function yt(r,t){return typeof r=="function"?r(t):r&&typeof r=="object"&&it in r?r[it](t):r instanceof Date?new r.constructor(t):new Date(t)}function lt(r,t){return yt(r,r)}function ja(r,t){const a=()=>yt(t==null?void 0:t.in,NaN),o=qa(r);let n;if(o.date){const l=Wa(o.date,2);n=Ga(l.restDateString,l.year)}if(!n||isNaN(+n))return a();const i=+n;let p=0,g;if(o.time&&(p=Ja(o.time),isNaN(p)))return a();if(o.timezone){if(g=Ka(o.timezone),isNaN(g))return a()}else{const l=new Date(i+p),x=lt(0);return x.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),x.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),x}return lt(i+p+g)}const Le={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Va=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ya=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Za=/^([+-])(\d{2})(?::?(\d{2}))?$/;function qa(r){const t={},a=r.split(Le.dateTimeDelimiter);let s;if(a.length>2)return t;if(/:/.test(a[0])?s=a[0]:(t.date=a[0],s=a[1],Le.timeZoneDelimiter.test(t.date)&&(t.date=r.split(Le.timeZoneDelimiter)[0],s=r.substr(t.date.length,r.length))),s){const o=Le.timezone.exec(s);o?(t.time=s.replace(o[1],""),t.timezone=o[1]):t.time=s}return t}function Wa(r,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=r.match(a);if(!s)return{year:NaN,restDateString:""};const o=s[1]?parseInt(s[1]):null,n=s[2]?parseInt(s[2]):null;return{year:n===null?o:n*100,restDateString:r.slice((s[1]||s[2]).length)}}function Ga(r,t){if(t===null)return new Date(NaN);const a=r.match(Va);if(!a)return new Date(NaN);const s=!!a[4],o=De(a[1]),n=De(a[2])-1,i=De(a[3]),p=De(a[4]),g=De(a[5])-1;if(s)return ar(t,p,g)?Xa(t,p,g):new Date(NaN);{const l=new Date(0);return!er(t,n,i)||!tr(t,o)?new Date(NaN):(l.setUTCFullYear(t,n,Math.max(o,i)),l)}}function De(r){return r?parseInt(r):1}function Ja(r){const t=r.match(Ya);if(!t)return NaN;const a=He(t[1]),s=He(t[2]),o=He(t[3]);return rr(a,s,o)?a*bt+s*xt+o*1e3:NaN}function He(r){return r&&parseFloat(r.replace(",","."))||0}function Ka(r){if(r==="Z")return 0;const t=r.match(Za);if(!t)return 0;const a=t[1]==="+"?-1:1,s=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return sr(s,o)?a*(s*bt+o*xt):NaN}function Xa(r,t,a){const s=new Date(0);s.setUTCFullYear(r,0,4);const o=s.getUTCDay()||7,n=(t-1)*7+a+1-o;return s.setUTCDate(s.getUTCDate()+n),s}const Qa=[31,null,31,30,31,30,31,31,30,31,30,31];function wt(r){return r%400===0||r%4===0&&r%100!==0}function er(r,t,a){return t>=0&&t<=11&&a>=1&&a<=(Qa[t]||(wt(r)?29:28))}function tr(r,t){return t>=1&&t<=(wt(r)?366:365)}function ar(r,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function rr(r,t,a){return r===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&r>=0&&r<25}function sr(r,t){return t>=0&&t<=59}var nr=H('<label class="field-option svelte-bp7ubz"><input type="radio" name="filter" class="svelte-bp7ubz"/> </label>'),or=H('<div class="date-range svelte-bp7ubz"><input type="date" class="svelte-bp7ubz"/> <input type="date" class="svelte-bp7ubz"/></div>'),ir=H('<div class="field-grid mb-2 svelte-bp7ubz" style="gap: 0.25rem 0.70rem;"><label class="field-option svelte-bp7ubz"><input type="radio" name="status-filter" value="processed" class="svelte-bp7ubz"/> <span class="inline-block px-5 py-1.5 rounded-full text-sm font-[Open_Sans] font-550 bg-[#CFEED8] text-[#1E9F37]">Processed</span></label> <label class="field-option svelte-bp7ubz"><input type="radio" name="status-filter" value="unprocessed" class="svelte-bp7ubz"/> <span class="inline-block px-3 py-1.5 rounded-full text-sm font-[Open_Sans] font-550 bg-[#FED9DA] text-[#D7313E]">Unprocessed</span></label></div>'),lr=H('<div class="filter-input svelte-bp7ubz"><input type="text" class="w-full px-2 py-1 border rounded mb-0.25"/></div>'),cr=H('<div class="filter-tag svelte-bp7ubz"> <button class="svelte-bp7ubz">×</button></div>'),dr=H('<div class="active-filters svelte-bp7ubz"><!> <button class="clear-button svelte-bp7ubz">Clear All</button></div>'),ur=H('<div class="dropdown-panel svelte-bp7ubz"><button class="close-button svelte-bp7ubz">✕</button> <div class="field-grid svelte-bp7ubz"></div> <hr class="divider svelte-bp7ubz"/> <!> <!></div>'),vr=H('<div class="dropdown svelte-bp7ubz"><button class="filter-button svelte-bp7ubz"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="svelte-bp7ubz"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"></path></svg> Filter</button> <!></div>');function fr(r,t){_e(t,!1);let a=Ve(t,"employees",24,()=>[]);const s=Ot();let o=j(!1),n=j(""),i=j(""),p=j(""),g=j(""),l=j([]);const x=["Employee No.","Date Hired","Cost Center","Name","Position","Rank","Department","Last Day","Status"];function K(){f(o,!e(o))}function D(N){f(n,N),f(i,""),f(p,""),f(g,"")}function T(){if(e(n)==="Date Hired"||e(n)==="Last Day"){if(e(p)&&e(g)){const N=new Date(e(p)).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),C=new Date(e(g)).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),J=`${N} to ${C}`;e(l).find(I=>I.field===e(n)&&I.value===J)||(f(l,[...e(l),{field:e(n),value:J}]),F()),f(n,""),f(p,""),f(g,"")}}else e(n)&&e(i)&&(e(l).find(C=>C.field===e(n)&&C.value===e(i))||(f(l,[...e(l),{field:e(n),value:e(i)}]),F()),f(n,""),f(i,""))}function b(N){f(l,e(l).filter((C,J)=>J!==N)),F()}function Z(){f(o,!1),f(n,""),f(i,"")}function q(){f(l,[]),F()}function F(){let N=a();e(l).forEach(C=>{const J=W(C.field);N=N.filter(X=>{var ae;const I=(ae=X[J])==null?void 0:ae.toString().toLowerCase(),ee=C.value.toLowerCase();if(C.field==="Employee No."||C.field==="Cost Center")return I===ee;if(C.field==="Date Hired"||C.field==="Last Day"){const[re,se]=C.value.split(" to ");try{const U=ja(X[J]);return U>=new Date(re)&&U<=new Date(se)}catch{return!1}}return C.field==="Status"?(I?"processed":"unprocessed")===ee.toLowerCase():I==null?void 0:I.toString().toLowerCase().includes(ee)})}),s("filter",{filtered:N})}function W(N){return{"Employee No.":"employee_no","Date Hired":"date_hired","Cost Center":"cost_center",Name:"name",Position:"position_title",Rank:"rank",Department:"department","Last Day":"last_day",Status:"processed_date_time"}[N]||N}Ee();var O=vr(),w=v(O),S=_(w,2);{var de=N=>{var C=ur(),J=v(C),X=_(J,2);Ye(X,5,()=>x,nt,(U,R)=>{var V=nr(),G=v(V);le(G);var u=_(G);d(V),ce(()=>{da(G,e(R)),ht(G,e(n)===e(R)),te(u,` ${e(R)??""}`)}),B("change",G,()=>D(e(R))),k(U,V)}),d(X);var I=_(X,4);{var ee=U=>{var R=or(),V=v(R);le(V);var G=_(V,2);le(G),d(R),pe(V,()=>e(p),u=>f(p,u)),B("change",V,()=>{e(p)&&e(g)&&(T(),f(o,!1))}),pe(G,()=>e(g),u=>f(g,u)),B("change",G,()=>{e(p)&&e(g)&&(T(),f(o,!1))}),k(U,R)},ae=(U,R)=>{{var V=u=>{var E=ir(),L=v(E),y=v(L);je(2),d(L);var M=_(L,2),A=v(M);je(2),d(M),d(E),B("change",y,()=>{f(i,"Processed"),T()}),B("change",A,()=>{f(i,"Unprocessed"),T()}),k(u,E)},G=u=>{var E=lr(),L=v(E);le(L),d(E),ce(()=>ua(L,"placeholder",`Enter ${e(n)}...`)),pe(L,()=>e(i),y=>f(i,y)),B("keydown",L,y=>{y.key==="Enter"&&T()}),k(u,E)};Y(U,u=>{e(n)==="Status"?u(V):u(G,!1)},R)}};Y(I,U=>{e(n)==="Date Hired"||e(n)==="Last Day"?U(ee):U(ae,!1)})}var re=_(I,2);{var se=U=>{var R=dr(),V=v(R);Ye(V,1,()=>e(l),nt,(u,E,L)=>{var y=cr(),M=v(y),A=_(M);d(y),ce(()=>te(M,`${e(E).field??""} = ${e(E).value??""} `)),B("click",A,()=>b(L)),k(u,y)});var G=_(V,2);d(R),B("click",G,q),k(U,R)};Y(re,U=>{e(l).length>0&&U(se)})}d(C),B("click",J,Z),k(N,C)};Y(S,N=>{e(o)&&N(de)})}d(O),B("click",w,K),k(r,O),xe()}var pr=H('<div class="flex items-center gap-2"><label for="start-date" class="text-sm text-gray-600 font-[Open_Sans]">From:</label> <input id="start-date" type="date" class="border border-gray-300 px-3 py-1 rounded-full text-sm font-[Open_Sans] uppercase"/> <label for="end-date" class="text-sm text-gray-600 font-[Open_Sans]">To:</label> <input id="end-date" type="date" class="border border-gray-300 px-3 py-1 rounded-full text-sm font-[Open_Sans] uppercase"/> <button><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"></path></svg> Export</button></div>');function hr(r,t){_e(t,!1);let a=j(""),s=j(""),o=j(!1);async function n(){if(!e(a)||!e(s)){alert("Please select both a start and end date.");return}try{const x=new Date(e(a)).toISOString(),K=new Date(e(s)).toISOString(),D=await fetch(`${fe}/resignees/report?start_date=${x}&end_date=${K}`,{credentials:"include"});if(!D.ok)throw new Error("Failed to fetch report from backend");const T=await D.blob(),b=URL.createObjectURL(T),Z=document.createElement("a");Z.href=b,Z.download=`resignee_report_${e(a)}_to_${e(s)}.csv`,Z.click(),URL.revokeObjectURL(b),f(o,!0)}catch(x){console.error("Error downloading backend report:",x),alert("No process dates were found within the specified date range")}}Ee();var i=pr(),p=_(v(i),2);le(p);var g=_(p,4);le(g);var l=_(g,2);d(i),ce(()=>_t(l,1,`flex items-center gap-2 px-4.25 py-1.75 rounded-md text-sm font-[Open_Sans] hover:bg-blue-600 transition ${e(o),"bg-blue-500 text-white"}`)),pe(p,()=>e(a),x=>f(a,x)),pe(g,()=>e(s),x=>f(s,x)),B("click",l,n),k(r,i),xe()}var gr=H('<button class="flex items-center gap-2 px-3 py-1.75 bg-red-500 text-white rounded-md hover:bg-red-600 transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"></path></svg> Logout</button>');function mr(r,t){_e(t,!1);async function a(){try{const o=await fetch(`${fe}/logout`,{method:"POST",credentials:"include"});if(!o.ok){const n=await o.text();console.error("Logout failed:",n);return}gt("/")}catch(o){console.error("Logout error:",o)}}Ee();var s=gr();B("click",s,a),k(r,s),xe()}var _r=H('<div class="flex items-center justify-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <span class="ml-3 text-gray-600">Loading employees...</span></div>'),xr=H('<div class="flex items-center justify-center py-12"><div class="text-red-600 bg-red-50 px-4 py-2 rounded-lg"> </div></div>'),br=H('<div class="overflow-auto max-h-[500px]"><!></div>'),yr=H('<div class="mt-4 text-sm text-gray-600"> </div>'),wr=H('<p class="mt-2 text-sm text-gray-700"> </p>'),kr=H('<main class="min-h-screen bg-gray-50 p-6"><div class="max-w-7xl mx-auto"><div class="flex flex-wrap items-center justify-between gap-4 mb-6"><div class="flex items-center gap-4 flex-1"><!></div> <div class="flex gap-2"><!> <!></div></div> <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"><!></div> <!></div> <form><div class="mt-4 max-w-7xl mx-auto mb-6"><textarea rows="5" class="block w-full p-4 text-gray-900 border border-gray-300 rounded-lg bg-white text-base resize-y" placeholder="Paste resignee details here..."></textarea> <div class="mt-4 flex justify-between items-center"><button type="submit" class="px-4.25 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition">Submit</button> <!></div> <!></div></form></main>');function Ar(r,t){_e(t,!1);let a=j([]),s=j([]),o=j(""),n=j(""),i="all",p=j(!0),g=j(""),l=j("");$t(async()=>{(await fetch(`${fe}/check-auth`,{method:"GET",credentials:"include"})).ok||(console.log("Unauthorized. Redirecting to login."),gt("/")),await x()});async function x(){try{f(p,!0),f(o,""),console.log("Attempting to fetch from:",`${fe}/resignees`);const u=new AbortController,E=setTimeout(()=>u.abort(),1e4),L=await fetch(`${fe}/resignees`,{signal:u.signal,credentials:"include"});if(clearTimeout(E),console.log("Response status:",L.status),console.log("Response ok:",L.ok),!L.ok){const M=await L.text();throw console.log("Error response:",M),new Error(`HTTP ${L.status}: ${M}`)}const y=await L.json();console.log("Received data:",y),console.log("Data length:",y==null?void 0:y.length),f(a,y||[]),f(p,!1)}catch(u){console.error("Load employees error:",u),u instanceof Error?u.name==="AbortError"?f(o,"Request timed out. Please check if the server is running."):u.message.includes("fetch")?f(o,"Cannot connect to server. Please check if the server is running on http://localhost:8000"):f(o,u.message):f(o,"An unexpected error occurred"),f(p,!1)}}function K(u){f(n,u.searchTerm)}function D(u){f(s,u.detail.filtered)}async function T(){if(e(g).trim())try{const u=await fetch(`${fe}/resignees`,{method:"POST",headers:{"Content-Type":"text/plain"},body:e(g),credentials:"include"});if(!u.ok){const E=await u.text();throw new Error(`HTTP error! status: ${u.status} - ${E}`)}await x(),f(g,"")}catch(u){u instanceof Error?f(l,`Error: ${u.message}`):f(l,`Error: ${String(u)}`)}}async function b(u){const{employee:E,action:L}=u.detail;try{let y,M;L?(y=L,M=L):E.processed_date_time?(y="unprocess",M="unprocess"):(y="process",M="process");const A=await fetch(`${fe}/resignees/${E.employee_no}/${y}`,{method:"PUT",credentials:"include"});if(!A.ok){const he=await A.text();throw new Error(`Failed to ${M} employee: ${A.status} - ${he}`)}await x();const oe=M==="process"?"processed":"unprocessed"}catch(y){const M=L||(E.processed_date_time?"unprocess":"process"),A=y instanceof Error?y.message:String(y);f(l,`Error ${M}ing employee: ${A}`)}}ft(()=>(e(n),e(a)),()=>{const u={january:0,jan:0,february:1,feb:1,march:2,mar:2,april:3,apr:3,may:4,june:5,jun:5,july:6,jul:6,august:7,aug:7,september:8,sep:8,october:9,oct:9,november:10,nov:10,december:11,dec:11},E=e(n).toLowerCase().trim(),L=u[E];f(s,e(a).filter(y=>{y.processed_date_time;const M=i==="all",A=be=>String(be||"").toLowerCase().includes(E),oe=new Date(y.date_hired),he=new Date(y.last_day),Te=L!==void 0&&(oe.getMonth()===L||he.getMonth()===L);return(E===""||A(y.name)||A(y.employee_no)||A(y.department)||A(y.position_title)||Te)&&M}))}),pt(),Ee();var Z=kr();la(u=>{oa.title="AUB Resignee Tracker"});var q=v(Z),F=v(q),W=v(F),O=v(W);Pa(O,{onsearch:K}),d(W);var w=_(W,2),S=v(w);fr(S,{get employees(){return e(a)},$$events:{filter:D}});var de=_(S,2);hr(de,{}),d(w),d(F);var N=_(F,2),C=v(N);{var J=u=>{var E=_r();k(u,E)},X=(u,E)=>{{var L=M=>{var A=xr(),oe=v(A),he=v(oe);d(oe),d(A),ce(()=>te(he,`Error: ${e(o)??""}`)),k(M,A)},y=M=>{var A=br(),oe=v(A);Oa(oe,{get employees(){return e(s)},onstatustoggle:b}),d(A),k(M,A)};Y(u,M=>{e(o)?M(L):M(y,!1)},E)}};Y(C,u=>{e(p)?u(J):u(X,!1)})}d(N);var I=_(N,2);{var ee=u=>{var E=yr(),L=v(E);d(E),ce(()=>te(L,`Showing ${e(s).length??""} of ${e(a).length??""} employees`)),k(u,E)};Y(I,u=>{!e(p)&&!e(o)&&u(ee)})}d(q);var ae=_(q,2),re=v(ae),se=v(re);ca(se);var U=_(se,2),R=_(v(U),2);mr(R,{}),d(U);var V=_(U,2);{var G=u=>{var E=wr(),L=v(E,!0);d(E),ce(()=>te(L,e(l))),k(u,E)};Y(V,u=>{e(l)&&u(G)})}d(re),d(ae),d(Z),pe(se,()=>e(g),u=>f(g,u)),B("submit",ae,ma(T)),k(r,Z),xe()}export{Ar as component};
