import{f as R,a as $}from"../chunks/CO5X12ro.js";import{i as C}from"../chunks/BhebSDih.js";import{o as G}from"../chunks/hoQZN_2d.js";import{p as O,t as P,g as a,a as z,s as n,$ as F,c as r,r as s,m as u,b as o}from"../chunks/DZq78Ezw.js";import{h as H,e as S,s as U}from"../chunks/sKjDUr9k.js";import{i as I}from"../chunks/BQGRK2Qk.js";import{b as A,B as D,r as E}from"../chunks/CdqjsRcG.js";import{g as w}from"../chunks/BZVhwD3b.js";var J=R('<div class="text-red-red-600 text-sm text-center"> </div>'),K=R(`<div class="min-h-screen flex items-center justify-center bg-gray-100 px-4 py-8"><div class="w-full max-w-sm"><form class="space-y-4"><div><label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label> <input id="username" name="username" type="text" required class="w-full px-3 py-2 bg-white border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 transition-colors disabled:opacity-50"/></div> <div><label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label> <input id="password" name="password" type="password" required class="w-full px-3 py-2 bg-white border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 transition-colors disabled:opacity-50"/></div> <!> <button type="submit" class="mt-6 w-full py-2 px-4 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white font-medium rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"> </button></form> <div class="mt-5 text-center"><p class="text-left text-sm text-gray-600 mb-1">Don't have an account yet?</p> <button type="button" class="border-3 border-blue-500 w-full py-2 px-4 hover:bg-gray-300 disabled:opacity-50 text-blue-500 font-medium rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition-colors">Sign Up</button></div></div></div>`);function re(T,q){O(q,!1);let m=u(""),p=u(""),i=u(!1),d=u("");G(async()=>{try{(await fetch(`${D}/check-auth`,{method:"GET",credentials:"include"})).ok&&(console.log("Already logged in. Redirecting to dashboard..."),w("/dashboard"))}catch{console.warn("Auth check failed. Please Login.")}});const B=async e=>{e.preventDefault(),o(i,!0),o(d,"");try{const t=new URLSearchParams;t.append("username",a(m)),t.append("password",a(p));const l=await fetch(`${D}/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,credentials:"include"});if(l.ok)w("/dashboard");else{const Q=await l.text();o(d,`Login failed (${l.status}). Please check your credentials.`)}}catch(t){t instanceof Error?o(d,`Network error: ${t.message}. Please try again.`):o(d,"Network error: An unknown error occurred. Please try again.")}finally{o(i,!1)}},M=()=>{w("/signup")};C();var f=K();H(e=>{F.title="Login"});var x=r(f),c=r(x),b=r(c),g=n(r(b),2);E(g),s(b);var v=n(b,2),h=n(r(v),2);E(h),s(v);var _=n(v,2);{var N=e=>{var t=J(),l=r(t,!0);s(t),P(()=>U(l,a(d))),$(e,t)};I(_,e=>{a(d)&&e(N)})}var y=n(_,2),j=r(y,!0);s(y),s(c);var k=n(c,2),L=n(r(k),2);s(k),s(x),s(f),P(()=>{g.disabled=a(i),h.disabled=a(i),y.disabled=a(i),U(j,a(i)?"Logging in...":"Login"),L.disabled=a(i)}),A(g,()=>a(m),e=>o(m,e)),A(h,()=>a(p),e=>o(p,e)),S("submit",c,B),S("click",L,M),$(T,f),z()}export{re as component};
